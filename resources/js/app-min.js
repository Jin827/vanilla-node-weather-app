!function(){const e=!!~location.href.indexOf("localhost")?"http://localhost:3000":"https://jh-weather.herokuapp.com",t=document.querySelector("#app"),n=t.querySelector(".city-form"),o=n.querySelector(".city-input"),r=t.querySelector(".contents-header"),a=t.querySelector(".current-summary"),i=t.querySelector(".current-right"),c=t.querySelector(".current-left"),l=t.querySelector(".daily-list"),s=[["clear-day","day-sunny"],["clear-night","night-clear"],["rain","rain"],["snow","snow"],["sleet","sleet"],["wind","windy"],["fog","fog"],["cloudy","cloudy"],["partly-cloudy-day","day-cloudy"],["partly-cloudy-night","night-partly-cloudy"],["hail","hail"],["thunderstorm","thunderstorm"],["tornado","tornado"]];function u(e){e.daily.map(e=>({time:e.time,icon:e.icon,tempMax:e.apparentTemperatureMax,tempMin:e.apparentTemperatureMin})).forEach(e=>{!function(e){const t=["Monday","Tuesday","Wednesday","Thursday","Friday","Saterday","Sunday"][new Date(1e3*e).getDay()],n=document.createElement("li");n.appendChild(document.createTextNode(t)),l.appendChild(n)}(e.time),function(e){const t=document.createElement("li");t.innerHTML="<i></i>",l.appendChild(t),s.forEach(n=>{if(e===n[0])return t.setAttribute("class",`d-icon wi wi-${n[1]}`)})}(e.icon),[[l,"li",e.tempMax,"max-temp"],[l,"li",e.tempMin,"min-temp"]].forEach(e=>{const t=document.createElement(e[1]);t.appendChild(document.createTextNode(e[2])),t.setAttribute("class",e[3]),e[0].appendChild(t)})})}function d(e){return new Promise(function(t,n){const o=function(e,t){let n=new XMLHttpRequest;return"withCredentials"in n?n.open(e,t,!0):"undefined"!=typeof XDomainRequest?(n=new XDomainRequest).open(e,t):n=null,n}("POST",e.url);console.log("cityInfo.url: ",e.url),o?(o.onload=function(){this.status>=200&&this.status<300?t(o.response):n(Error(o.statusText))},o.onerror=function(){n(Error("Network Error")),alert("Woops, there was an error making the request.")},o.setRequestHeader("Content-type","application/json"),o.send(e.data)):alert("CORS not supported")})}function m(){return new Promise(function(e,t){navigator.geolocation.getCurrentPosition(e,function(e){alert("Oops! There is a problem with Geolocation API connection. Please use the website search engine."),console.warn(`ERROR(${e.code}): ${e.message}`)},{maximumAge:0})})}function p(e){const t=[o,r,a,i,c,l],n=JSON.parse(e);t.forEach(e=>e.innerHTML="");const d=[function(e){const t=document.createElement("li");t.innerHTML="<i></i>",a.appendChild(t),s.forEach(n=>{if(e===n[0])return t.setAttribute("class",`c-icon wi wi-${n[1]}`)})}(n.weather.icon),function(e){const{apparentTemperature:t,pressure:n,humidity:o,summary:l,temperature:s,uvIndex:u,windSpeed:d,visibility:m}=e.weather,p=[[r,"H3",e.cityName," "],[r,"p",l," "],[a,"p",s+" °C","w-temperature"]],h=[[c,"FEELS LIKE",t," °"],[c,"HUMIDITY",o," %"],[c,"WIND",d," Km/h"],[i,"UV INDEX",u," of 10"],[i,"PRESSURE",n," hPa"],[i,"VISIBILITY",m," Km"]];p.forEach(e=>{const t=document.createElement(e[1]);t.appendChild(document.createTextNode(e[2])),t.setAttribute("class",e[3]),e[0].appendChild(t)}),h.forEach(e=>{const t=document.createElement("li");t.innerHTML=`<span class="current-span">${e[1]}</span> <br>`+`${e[2]}`+`${e[3]}`,e[0].appendChild(t)}),document.getElementById("current-list").style.borderTop="1px solid #333",document.getElementById("current-list").style.borderBottom="1px solid #333"}(n),u(n),function(e){const{temperature:t}=e.weather,n=document.getElementById("section-weather");return t>20?n.style.backgroundImage="url('resources/img/clear-sky-min.jpeg')":t>0?n.style.backgroundImage="url('resources/img/cloud-min.jpeg')":t<=0?n.style.backgroundImage="url('resources/img/snow-min.jpeg')":void 0}(n)];Promise.all(d)}window.onload=function(){confirm("Allow this website to know your location ?")&&m().then(t=>({data:JSON.stringify({lat:t.coords.latitude,lng:t.coords.longitude}),url:`${e}/geolocation`})).then(d).then(p).catch(e=>console.log("Something went wrong!"))},n.addEventListener("submit",function(t){t.preventDefault();const n=o.value,r=JSON.stringify({city:n});n?d({data:r,url:`${e}/search`}).then(p).catch(e=>console.log("Something went wrong!")):alert("Please enter a city name"),o.value=""})}();